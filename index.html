<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ„ AI Mario â€” LS Studio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LS STUDIO SPLASH SCREEN
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="ls-splash">
    <div class="splash-inner">
      <div class="ls-logo-mark">LS</div>
      <div class="ls-text">
        <div class="ls-name">LS STUDIO</div>
        <div class="ls-sub">by Yatharth</div>
      </div>
      <div class="ls-bar-wrap">
        <div class="ls-bar" id="lsBar"></div>
      </div>
      <div class="ls-load-txt" id="lsTxt">LOADING...</div>
    </div>
    <div class="ls-presents">LS STUDIO PRESENTS</div>
  </div>

  <!-- floating pixel particles -->
  <div class="pixels-bg" id="pixelsBg"></div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FIXED HEADER
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <header id="main-header">
    <div class="logo">ğŸ„ AI MARIO</div>
    <div class="header-right">
      <span class="badge badge-p5">p5.js</span>
      <span class="badge badge-ml5">ml5 Â· PoseNet</span>
      <span class="ls-tag"><span class="ls-dot"></span>LS Studio</span>
    </div>
  </header>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAIN PAGE
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page">

    <!-- hero -->
    <div class="game-hero">
      <h1>CONTROL WITH YOUR BODY</h1>
      <p>Tilt head <span>left / right</span> to move &nbsp;Â·&nbsp; Look <span>up</span> to jump</p>
    </div>

    <!-- â”€â”€ MAIN GRID â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="game-layout">

      <!-- LEFT: Game Canvas -->
      <div class="canvas-col">

        <div class="canvas-container">
          <!--
            id="game-canvas" â†’ p5.js injects <canvas> here via:
            createCanvas(w,h).parent('game-canvas')  â† in main.js setup()
          -->
          <div id="game-canvas"></div>
        </div>

        <!-- HUD bar below canvas â€” updated by updateHUD() in this file -->
        <div class="statusbar">
          <div class="stat">
            <span class="stat-icon">ğŸ†</span>
            <div>
              <span class="stat-lbl">SCORE</span>
              <!-- id="hud-score" written by updateHUD() -->
              <span class="stat-val" id="hud-score">0</span>
            </div>
          </div>
          <div class="stat">
            <span class="stat-icon">ğŸ„</span>
            <div>
              <span class="stat-lbl">LEVEL</span>
              <span class="stat-val">1-1</span>
            </div>
          </div>
          <div class="stat">
            <span class="stat-icon">â±</span>
            <div>
              <span class="stat-lbl">TIME</span>
              <!-- id="hud-time" written by updateHUD() -->
              <span class="stat-val" id="hud-time">000</span>
            </div>
          </div>
          <div class="stat">
            <span class="stat-icon">ğŸ’°</span>
            <div>
              <span class="stat-lbl">COINS</span>
              <!-- id="hud-coins" written by updateHUD() -->
              <span class="stat-val gold" id="hud-coins">Ã—00</span>
            </div>
          </div>
        </div>
      </div><!-- /canvas-col -->

      <!-- RIGHT: Sidebar -->
      <div class="sidebar">

        <!-- CAMERA CARD
             id="game_console" â†’ p5.js injects <video> here via:
             video.parent('game_console')  â† in main.js setup()
        -->
        <div class="card card-camera">
          <div class="card-title">ğŸ“· CAMERA FEED</div>
          <div class="cam-wrap">
            <div id="game_console"></div>
            <div class="cam-overlay"></div>
            <!-- id="trackPulse" toggled by updateTracking() -->
            <div class="track-pulse" id="trackPulse"></div>
            <!-- id="trackStatus" text set by updateTracking() -->
            <div class="track-status searching" id="trackStatus">SEARCHING...</div>
          </div>
        </div>

        <!-- PLAY BUTTON CARD
             onclick="startGame()" â†’ startGame() defined in characters_environment.js
             id="game-status"      â†’ text set by startGame(), modelLoaded(), updateTracking()
        -->
        <div class="card">
          <div class="card-title">ğŸ® START GAME</div>
          <button id="start-btn" onclick="startGame()">â–¶ PLAY</button>
          <div id="game-status">WAITING FOR CAMERA...</div>
        </div>

        <!-- LIVE STATS
             ids: stat-kills, stat-coins, stat-score â†’ updated by updateHUD()
             class: heart â†’ toggled alive/lost by updateHUD()
        -->
        <div class="card">
          <div class="card-title">ğŸ“Š LIVE STATS</div>
          <div class="score-grid">
            <div class="score-row">
              <span class="score-key">LIVES</span>
              <div class="hearts" id="hearts-wrap">
                <span class="heart alive">â¤ï¸</span>
                <span class="heart alive">â¤ï¸</span>
                <span class="heart alive">â¤ï¸</span>
                <span class="heart alive">â¤ï¸</span>
              </div>
            </div>
            <div class="score-row">
              <span class="score-key">KILLS</span>
              <span class="score-val red" id="stat-kills">0</span>
            </div>
            <div class="score-row">
              <span class="score-key">COINS</span>
              <span class="score-val gold" id="stat-coins">0</span>
            </div>
            <div class="score-row">
              <span class="score-key">SCORE</span>
              <span class="score-val" id="stat-score">0</span>
            </div>
          </div>
        </div>

        <!-- HIGHSCORE
             id="hs-val" â†’ updated by updateHUD() via localStorage
        -->
        <div class="card">
          <div class="hs-banner">
            <div class="hs-label">ğŸ† HIGH SCORE</div>
            <div class="hs-val" id="hs-val">0</div>
          </div>
        </div>

        <!-- HOW TO PLAY -->
        <div class="card">
          <div class="card-title">ğŸ“– HOW TO PLAY</div>
          <div class="steps">
            <div class="step"><div class="step-n">1</div><div class="step-t">Allow <strong>camera access</strong></div></div>
            <div class="step"><div class="step-n">2</div><div class="step-t">Wait for <strong>PoseNet</strong> to find your face</div></div>
            <div class="step"><div class="step-n">3</div><div class="step-t">Tilt head <strong>left / right</strong> to move</div></div>
            <div class="step"><div class="step-n">4</div><div class="step-t">Look <strong>up</strong> to jump Â· <strong>SPACE</strong> to restart</div></div>
          </div>
        </div>

        <!-- CONTROLS -->
        <div class="card">
          <div class="card-title">âŒ¨ï¸ CONTROLS</div>
          <div class="ctrl-grid">
            <div class="ctrl-item"><span class="ctrl-icon">â†</span><div><div class="ctrl-lbl">Move Left</div><div class="ctrl-sub">Nose X &lt; 300</div></div></div>
            <div class="ctrl-item"><span class="ctrl-icon">â†’</span><div><div class="ctrl-lbl">Move Right</div><div class="ctrl-sub">Nose X &gt; 300</div></div></div>
            <div class="ctrl-item"><span class="ctrl-icon">â†‘</span><div><div class="ctrl-lbl">Jump</div><div class="ctrl-sub">Nose Y &lt; 200</div></div></div>
            <div class="ctrl-item"><span class="ctrl-icon">âµ</span><div><div class="ctrl-lbl">Restart</div><div class="ctrl-sub">Game Over</div></div></div>
          </div>
        </div>

      </div><!-- /sidebar -->
    </div><!-- /game-layout -->

    <footer>
      <div class="footer-brand">
        <span class="footer-ls">LS STUDIO</span>
        <span class="footer-sep">Ã—</span>
        <span class="footer-name">Yatharth</span>
      </div>
      <div class="footer-copy">Built with <span class="heart-red">â™¥</span> Â· p5.js Â· ml5.js PoseNet Â· p5.play</div>
    </footer>

  </div><!-- /page -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCRIPTS â€” load order matters!
       1. p5.js       (core library)
       2. p5_play.js  (sprite engine)
       3. ml5.js      (AI / PoseNet)
       4. sprites.js  (defines setSprites, MarioAnimation â€” uses p5 + p5_play)
       5. characters_environment.js  (game logic â€” uses sprites globals)
       6. main.js     (setup/draw â€” uses everything above)
       7. inline JS   (HUD, splash, particles â€” runs after DOM ready)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <script src="p5.js"></script>
  <script src="p5_play.js"></script>
  <script src="https://unpkg.com/ml5@0.5.0/dist/ml5.min.js"></script>
  <script src="sprites.js"></script>
  <script src="characters_environment.js"></script>
  <script src="main.js"></script>

  <script>
    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       INLINE JS â€” wires HTML elements to game state
       Runs after all game scripts are loaded
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    /* 1. Pixel particles background */
    (function spawnPixels() {
      var bg   = document.getElementById('pixelsBg');
      var cols = ['#6d8fff','#e52222','#f7c948','#2dc653','#ffffff'];
      for (var i = 0; i < 40; i++) {
        var d = document.createElement('div');
        d.className = 'pixel-dot';
        d.style.left              = (Math.random() * 100) + 'vw';
        d.style.background        = cols[i % cols.length];
        d.style.animationDuration = (10 + Math.random() * 18) + 's';
        d.style.animationDelay    = (Math.random() * 20) + 's';
        d.style.opacity           = 0.15 + Math.random() * 0.35;
        bg.appendChild(d);
      }
    })();

    /* 2. HUD updater â€” reads from gameConfig + mario (defined in characters_environment.js) */
    var _hs = parseInt(localStorage.getItem('marioHS') || '0');
    document.getElementById('hs-val').textContent = _hs;

    function updateHUD() {
      /* gameConfig is a global from characters_environment.js */
      if (typeof gameConfig === 'undefined') return;

      var score = Math.round(gameConfig.scores);
      var time  = Math.round(gameConfig.timeScores);
      /* mario is a global sprite created in sprites.js â†’ MarioAnimation() */
      var coins = (typeof mario !== 'undefined') ? mario.coins      : 0;
      var kills = (typeof mario !== 'undefined') ? mario.kills      : 0;
      var lives = (typeof mario !== 'undefined') ? mario.liveNumber : 4;

      /* Update HUD bar */
      document.getElementById('hud-score').textContent = score;
      document.getElementById('hud-time').textContent  = String(time).padStart(3, '0');
      document.getElementById('hud-coins').textContent = 'Ã—' + String(coins).padStart(2, '0');

      /* Update sidebar stats */
      document.getElementById('stat-score').textContent = score;
      document.getElementById('stat-coins').textContent = coins;
      document.getElementById('stat-kills').textContent = kills;

      /* Update hearts */
      document.querySelectorAll('.heart').forEach(function(h, i) {
        if (i < lives) { h.classList.add('alive');  h.classList.remove('lost'); }
        else            { h.classList.remove('alive'); h.classList.add('lost'); }
      });

      /* Highscore */
      if (score > _hs) {
        _hs = score;
        localStorage.setItem('marioHS', _hs);
        document.getElementById('hs-val').textContent = _hs;
      }
    }
    setInterval(updateHUD, 250);

    /* 3. Camera / PoseNet tracking status
          noseX is a global set in main.js â†’ gotPoses() */
    function updateTracking() {
      if (typeof noseX === 'undefined') return;
      var pulse  = document.getElementById('trackPulse');
      var status = document.getElementById('trackStatus');
      var gstat  = document.getElementById('game-status');

      if (noseX !== '') {
        pulse.classList.add('on');
        status.className = 'track-status ok';
        status.textContent = 'â— TRACKING';
        /* Only update if game hasn't started yet */
        if (typeof gameConfig !== 'undefined' && gameConfig.status === 'start') {
          gstat.textContent = 'FACE DETECTED â€” PRESS PLAY!';
        }
      } else {
        pulse.classList.remove('on');
        status.className = 'track-status searching';
        status.textContent = 'SEARCHING...';
      }
    }
    setInterval(updateTracking, 400);

    /* 4. LS Studio splash screen animation */
    (function runSplash() {
      var bar  = document.getElementById('lsBar');
      var txt  = document.getElementById('lsTxt');
      var sp   = document.getElementById('ls-splash');
      var msgs = ['LOADING...', 'INITIALIZING ENGINE...', 'LOADING SPRITES...', 'SETTING UP AI...', 'âœ“ READY!'];
      var p = 0, mi = 0;

      /* Start after logo animation (~1.3s) */
      setTimeout(function() {
        var iv = setInterval(function() {
          p += Math.random() * 9 + 4;
          if (p >= 100) p = 100;
          bar.style.width = p + '%';

          var ni = Math.floor((p / 100) * (msgs.length - 1));
          if (ni !== mi) { mi = ni; txt.textContent = msgs[mi]; }

          if (p >= 100) {
            clearInterval(iv);
            setTimeout(function() { sp.classList.add('hidden'); }, 700);
          }
        }, 110);
      }, 1300);
    })();
  </script>

</body>
</html>
