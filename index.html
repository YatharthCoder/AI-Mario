<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üçÑ AI Mario ‚Äî LS Studio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div id="ls-splash">
    <div class="splash-inner">
      <div class="ls-logo-mark">LS</div>
      <div class="ls-text">
        <div class="ls-name">LS STUDIO</div>
        <div class="ls-sub">by Yatharth</div>
      </div>
      <div class="ls-bar-wrap">
        <div class="ls-bar" id="lsBar"></div>
      </div>
      <div class="ls-load-txt" id="lsTxt">LOADING...</div>
    </div>
    <div class="ls-presents">LS STUDIO PRESENTS</div>
  </div>

  <div class="pixels-bg" id="pixelsBg"></div>

  <header id="main-header">
    <div class="logo">üçÑ AI MARIO</div>
    <div class="header-right">
      <span class="badge badge-p5">p5.js</span>
      <span class="badge badge-ml5">ml5 ¬∑ PoseNet</span>
      <span class="ls-tag"><span class="ls-dot"></span>LS Studio</span>
    </div>
  </header>

  <div class="page">

    <div class="game-hero">
      <h1>CONTROL WITH YOUR BODY</h1>
      <p>Tilt head <span>left / right</span> to move &nbsp;¬∑&nbsp; Look <span>up</span> to jump</p>
    </div>

    <div class="game-layout">

      <!-- LEFT: Game Canvas -->
      <div class="canvas-col">
        <div class="canvas-container">
          <!-- main.js: canvas.parent("canvas") ‚Äî id MUST be "canvas" -->
          <div id="canvas"></div>
        </div>
        <div class="statusbar">
          <div class="stat"><span class="stat-icon">üèÜ</span><div><span class="stat-lbl">SCORE</span><span class="stat-val" id="hud-score">0</span></div></div>
          <div class="stat"><span class="stat-icon">üçÑ</span><div><span class="stat-lbl">LEVEL</span><span class="stat-val">1-1</span></div></div>
          <div class="stat"><span class="stat-icon">‚è±</span><div><span class="stat-lbl">TIME</span><span class="stat-val" id="hud-time">000</span></div></div>
          <div class="stat"><span class="stat-icon">üí∞</span><div><span class="stat-lbl">COINS</span><span class="stat-val gold" id="hud-coins">√ó00</span></div></div>
        </div>
      </div>

      <!-- RIGHT: Sidebar -->
      <div class="sidebar">

        <div class="card card-camera">
          <div class="card-title">üì∑ CAMERA FEED</div>
          <div class="cam-wrap">
            <!-- main.js: video.parent('game_console') ‚Äî id MUST be "game_console" -->
            <div id="game_console"></div>
            <div class="cam-overlay"></div>
            <div class="track-pulse" id="trackPulse"></div>
            <div class="track-status searching" id="trackStatus">SEARCHING...</div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">üéÆ START GAME</div>
          <!-- startGame() is in characters_environment.js -->
          <button id="start-btn" onclick="startGame()">‚ñ∂ PLAY</button>
          <!-- characters_environment.js line 62 writes to id="status" ‚Äî MUST be "status" -->
          <div id="status">WAITING FOR CAMERA...</div>
        </div>

        <div class="card">
          <div class="card-title">üìä LIVE STATS</div>
          <div class="score-grid">
            <div class="score-row">
              <span class="score-key">LIVES</span>
              <div class="hearts" id="hearts-wrap">
                <span class="heart alive">‚ù§Ô∏è</span>
                <span class="heart alive">‚ù§Ô∏è</span>
                <span class="heart alive">‚ù§Ô∏è</span>
                <span class="heart alive">‚ù§Ô∏è</span>
              </div>
            </div>
            <div class="score-row"><span class="score-key">KILLS</span><span class="score-val red" id="stat-kills">0</span></div>
            <div class="score-row"><span class="score-key">COINS</span><span class="score-val gold" id="stat-coins">0</span></div>
            <div class="score-row"><span class="score-key">SCORE</span><span class="score-val" id="stat-score">0</span></div>
          </div>
        </div>

        <div class="card">
          <div class="hs-banner">
            <div class="hs-label">üèÜ HIGH SCORE</div>
            <div class="hs-val" id="hs-val">0</div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">üìñ HOW TO PLAY</div>
          <div class="steps">
            <div class="step"><div class="step-n">1</div><div class="step-t">Allow <strong>camera access</strong></div></div>
            <div class="step"><div class="step-n">2</div><div class="step-t">Wait for <strong>PoseNet</strong> to find your face</div></div>
            <div class="step"><div class="step-n">3</div><div class="step-t">Tilt head <strong>left / right</strong> to move</div></div>
            <div class="step"><div class="step-n">4</div><div class="step-t">Look <strong>up</strong> to jump ¬∑ <strong>SPACE</strong> to restart</div></div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">‚å®Ô∏è CONTROLS</div>
          <div class="ctrl-grid">
            <div class="ctrl-item"><span class="ctrl-icon">‚Üê</span><div><div class="ctrl-lbl">Move Left</div><div class="ctrl-sub">Nose X &lt; 300</div></div></div>
            <div class="ctrl-item"><span class="ctrl-icon">‚Üí</span><div><div class="ctrl-lbl">Move Right</div><div class="ctrl-sub">Nose X &gt; 300</div></div></div>
            <div class="ctrl-item"><span class="ctrl-icon">‚Üë</span><div><div class="ctrl-lbl">Jump</div><div class="ctrl-sub">Nose Y &lt; 200</div></div></div>
            <div class="ctrl-item"><span class="ctrl-icon">‚éµ</span><div><div class="ctrl-lbl">Restart</div><div class="ctrl-sub">Game Over</div></div></div>
          </div>
        </div>

      </div>
    </div>

    <footer>
      <div class="footer-brand">
        <span class="footer-ls">LS STUDIO</span>
        <span class="footer-sep">√ó</span>
        <span class="footer-name">Yatharth</span>
      </div>
      <div class="footer-copy">Built with <span class="heart-red">‚ô•</span> ¬∑ p5.js ¬∑ ml5.js PoseNet ¬∑ p5.play</div>
    </footer>

  </div>

  <!--
    SCRIPT PATHS ‚Äî fixed for YOUR folder structure:
      lib/p5.min.js       = lib folder
      lib/p5.play.js      = lib folder
      lib/p5.dom.js       = lib folder
      ml5 @0.4.3 CDN      = same as your original working HTML
      scripts/sprites.js  = scripts folder
      characters_environment.js = root
      main.js             = root
      p5.sound @1.0.0 CDN = same as your original working HTML
  -->
  <script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>
  <script src="lib/p5.min.js"></script>
  <script src="lib/p5.play.js"></script>
  <script src="lib/p5.dom.js"></script>
  <script src="scripts/sprites.js"></script>
  <script src="characters_environment.js"></script>
  <script src="main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/addons/p5.sound.min.js"></script>

  <script>
    /* Pixel particles */
    (function() {
      var bg = document.getElementById('pixelsBg');
      var cols = ['#6d8fff','#e52222','#f7c948','#2dc653','#ffffff'];
      for (var i = 0; i < 40; i++) {
        var d = document.createElement('div');
        d.className = 'pixel-dot';
        d.style.left = (Math.random()*100)+'vw';
        d.style.background = cols[i%cols.length];
        d.style.animationDuration = (10+Math.random()*18)+'s';
        d.style.animationDelay = (Math.random()*20)+'s';
        d.style.opacity = 0.15+Math.random()*0.35;
        bg.appendChild(d);
      }
    })();

    /* HUD updater ‚Äî reads gameConfig + mario from characters_environment.js */
    var _hs = parseInt(localStorage.getItem('marioHS')||'0');
    document.getElementById('hs-val').textContent = _hs;

    function updateHUD() {
      if (typeof gameConfig === 'undefined') return;
      var score = Math.round(gameConfig.scores);
      var time  = Math.round(gameConfig.timeScores);
      var coins = (typeof mario !== 'undefined') ? mario.coins      : 0;
      var kills = (typeof mario !== 'undefined') ? mario.kills      : 0;
      var lives = (typeof mario !== 'undefined') ? mario.liveNumber : 4;
      document.getElementById('hud-score').textContent = score;
      document.getElementById('hud-time').textContent  = String(time).padStart(3,'0');
      document.getElementById('hud-coins').textContent = '√ó'+String(coins).padStart(2,'0');
      document.getElementById('stat-score').textContent = score;
      document.getElementById('stat-coins').textContent = coins;
      document.getElementById('stat-kills').textContent = kills;
      document.querySelectorAll('.heart').forEach(function(h,i){
        if(i<lives){h.classList.add('alive');h.classList.remove('lost');}
        else{h.classList.remove('alive');h.classList.add('lost');}
      });
      if(score>_hs){_hs=score;localStorage.setItem('marioHS',_hs);document.getElementById('hs-val').textContent=_hs;}
    }
    setInterval(updateHUD, 250);

    /* Camera tracking status ‚Äî reads noseX from main.js */
    function updateTracking() {
      if (typeof noseX === 'undefined') return;
      var pulse  = document.getElementById('trackPulse');
      var status = document.getElementById('trackStatus');
      var gstat  = document.getElementById('status');
      if (noseX !== '') {
        pulse.classList.add('on');
        status.className   = 'track-status ok';
        status.textContent = '‚óè TRACKING';
        if (typeof gameConfig !== 'undefined' && gameConfig.status === 'start')
          gstat.textContent = 'FACE DETECTED ‚Äî PRESS PLAY!';
      } else {
        pulse.classList.remove('on');
        status.className   = 'track-status searching';
        status.textContent = 'SEARCHING...';
      }
    }
    setInterval(updateTracking, 400);

    /* Splash screen */
    (function() {
      var bar  = document.getElementById('lsBar');
      var txt  = document.getElementById('lsTxt');
      var sp   = document.getElementById('ls-splash');
      var msgs = ['LOADING...','INITIALIZING ENGINE...','LOADING SPRITES...','SETTING UP AI...','‚úì READY!'];
      var p=0, mi=0;
      setTimeout(function(){
        var iv = setInterval(function(){
          p += Math.random()*9+4;
          if(p>=100) p=100;
          bar.style.width = p+'%';
          var ni = Math.floor((p/100)*(msgs.length-1));
          if(ni!==mi){mi=ni;txt.textContent=msgs[mi];}
          if(p>=100){clearInterval(iv);setTimeout(function(){sp.classList.add('hidden');},700);}
        },110);
      },1300);
    })();
  </script>

</body>
</html>
